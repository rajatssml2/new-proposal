"use strict";(self.webpackChunkproposal_app=self.webpackChunkproposal_app||[]).push([[960],{960:(N,m,i)=>{i.r(m),i.d(m,{ProposalModule:()=>A});var u=i(895),p=i(114),a=i(433),g=i(226),d=i.n(g),o=i(256);function h(n,l){if(1&n){const t=o.EpF();o.TgZ(0,"span",28),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.onDownloadFile())}),o._UZ(1,"i",29),o.qZA()}}function _(n,l){if(1&n){const t=o.EpF();o.TgZ(0,"button",30),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.submit())}),o._uU(1,"Submit"),o.qZA()}}function b(n,l){if(1&n){const t=o.EpF();o.TgZ(0,"button",31),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.onApproveByStateManager())}),o._uU(1,"Approve"),o.qZA()}}function Z(n,l){if(1&n){const t=o.EpF();o.TgZ(0,"button",31),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.onSendToIVA())}),o._uU(1,"Send to IVA"),o.qZA()}}function w(n,l){1&n&&(o.TgZ(0,"button",32),o._uU(1,"Send for modification"),o.qZA())}function y(n,l){1&n&&(o.TgZ(0,"button",33),o._uU(1,"Reject"),o.qZA())}let f=(()=>{class n{constructor(t,e,r){this.fb=t,this.route=e,this.router=r,this.proposalForm=a.cw,this.isDownloadIconShow=!1,this.proposalArr=[],this.isReadOnly=!1,this.loginUser="",this.currentUrl="",this.currentUrl=this.router.url,console.log(this.currentUrl)}ngOnInit(){this.proposalForm=this.fb.group({id:["",a.kI.required],purpose:["",a.kI.required],category:[{value:"",disabled:!1},[a.kI.required]],upload:[{value:"",disabled:!1}],fileSource:new a.NI("",[a.kI.required]),remarks:["",[a.kI.required]],sentTo:[{value:"",disabled:!1},[a.kI.required]],status:[""]});let t=localStorage.getItem("loginUser");this.loginUser=t;let e=this.route.snapshot.paramMap.get("items");if(e=JSON.parse(e),console.log(e),e){let r=localStorage.getItem("proposalData");r=JSON.parse(r),r.find(c=>c.id===e),console.log("val=",r),this.proposalForm.patchValue({id:r[0].id,purpose:r[0].purpose,remarks:r[0].remarks,sentTo:r[0].sentTo,category:r[0].category,fileSource:r[0].fileSource}),this.isDownloadIconShow=!0,this.fileSrc=r[0].fileSource,this.isReadOnly=!0,this.proposalForm.controls.category.disable(),this.proposalForm.controls.upload.disable(),this.proposalForm.controls.sentTo.disable();let s=localStorage.getItem("loginUser");this.loginUser=s}}onDownloadFile(){this.downloadPdf(this.fileSrc,"sample")}downloadPdf(t,e){const r=t,s=document.createElement("a"),[,c]=t.split(";")[0].split("/");s.href=r,s.download=`${e}.${c}`,s.click()}onFileChange(t){if(t.target.files.length>0){const e=new FileReader;e.addEventListener("load",()=>{this.proposalForm.patchValue({fileSource:e.result}),this.isDownloadIconShow=!0,this.fileSrc=e.result}),e.readAsDataURL(t.target.files[0])}}submit(){let t=Math.floor(1e6*Math.random());this.proposalForm.patchValue({id:t,status:"Submitted by state officer"});const e=new FormData;e.append("upload",this.proposalForm.get("fileSource").value),console.log(this.proposalForm,e);let r=[this.proposalForm.value];r.push(),localStorage.setItem("proposalData",JSON.stringify(r)),d().fire({title:"Data saved successfully",text:"Proposal id: "+t,showDenyButton:!1,showCancelButton:!1,confirmButtonText:"Ok"}).then(s=>{s.isConfirmed&&this.router.navigate(["dashboard"])})}onApproveByStateManager(){let t=localStorage.getItem("proposalData");t=JSON.parse(t),t[0].status="Approved by state manager",localStorage.setItem("proposalData",JSON.stringify(t)),d().fire({title:"Proposal approved successfully",showDenyButton:!1,showCancelButton:!1,confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&this.router.navigate(["dashboard"])})}onSendToIVA(){let t=localStorage.getItem("proposalData");t=JSON.parse(t),t[0].status="Pending with IVA",localStorage.setItem("proposalData",JSON.stringify(t)),d().fire({title:"Proposal sent to IVA successfully",showDenyButton:!1,showCancelButton:!1,confirmButtonText:"Ok"}).then(e=>{e.isConfirmed&&this.router.navigate(["dashboard"])})}onCancel(){this.router.navigate(["dashboard"])}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(a.qu),o.Y36(p.gz),o.Y36(p.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-new"]],decls:46,vars:13,consts:[[2,"padding","80px"],[1,"sub-header"],[1,"row","g-3",3,"formGroup"],[1,"col-md-12"],["for","purpose",1,"form-label"],["formControlName","purpose","id","purpose",1,"form-control",3,"readonly"],[1,"col-md-6"],["for","category",1,"form-label"],["formControlName","category","name","category","id","category",1,"form-select",3,"disabled"],["selected",""],["value","Potholes fix"],["value","Village road construction"],["value","Flood area road repair"],[1,"col-6"],["for","upload",1,"form-label"],["formControlName","upload","type","file","id","upload","id","customFile",1,"form-control",3,"disabled","readonly","change"],["class","download-proposal-icon",3,"click",4,"ngIf"],["for","remarks",1,"form-label"],["formControlName","remarks","type","text","id","remarks","placeholder","Remarks ....",1,"form-control",3,"readonly"],["for","sentto",1,"form-label"],["formControlName","sentTo","name","sentto","id","sentto",1,"form-select",3,"disabled"],["value","State transport manage"],[1,"d-flex","gap-2","col-2","mx-auto"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["class","btn btn-success","type","button",3,"click",4,"ngIf"],["class","btn btn-warning","type","button",4,"ngIf"],["class","btn btn-danger","type","button",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"download-proposal-icon",3,"click"],[1,"fa","fa-download"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-warning"],["type","button",1,"btn","btn-danger"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0)(1,"div",1)(2,"h5"),o._uU(3,"New Proposal"),o.qZA()(),o.TgZ(4,"form",2)(5,"div",3)(6,"label",4),o._uU(7,"Purpose"),o.qZA(),o._UZ(8,"textarea",5),o.qZA(),o.TgZ(9,"div",6)(10,"label",7),o._uU(11,"Category"),o.qZA(),o.TgZ(12,"select",8)(13,"option",9),o._uU(14,"Choose..."),o.qZA(),o.TgZ(15,"option",10),o._uU(16,"Potholes fix"),o.qZA(),o.TgZ(17,"option",11),o._uU(18,"Village road construction"),o.qZA(),o.TgZ(19,"option",12),o._uU(20,"Flood area road repair"),o.qZA()()(),o.TgZ(21,"div",13)(22,"label",14),o._uU(23,"Upload"),o.qZA(),o.TgZ(24,"input",15),o.NdJ("change",function(s){return e.onFileChange(s)}),o.qZA(),o.YNc(25,h,2,0,"span",16),o.qZA(),o.TgZ(26,"div",13)(27,"label",17),o._uU(28,"Remarks"),o.qZA(),o._UZ(29,"input",18),o.qZA(),o.TgZ(30,"div",6)(31,"label",19),o._uU(32,"Sent to"),o.qZA(),o.TgZ(33,"select",20)(34,"option",9),o._uU(35,"Choose..."),o.qZA(),o.TgZ(36,"option",21),o._uU(37,"State transport manager"),o.qZA()()(),o.TgZ(38,"div",22),o.YNc(39,_,2,0,"button",23),o.YNc(40,b,2,0,"button",24),o.YNc(41,Z,2,0,"button",24),o.YNc(42,w,2,0,"button",25),o.YNc(43,y,2,0,"button",26),o.TgZ(44,"button",27),o.NdJ("click",function(){return e.onCancel()}),o._uU(45,"Cancel"),o.qZA()()()()),2&t&&(o.xp6(4),o.Q6J("formGroup",e.proposalForm),o.xp6(4),o.Q6J("readonly",e.isReadOnly),o.xp6(4),o.Q6J("disabled",e.isReadOnly),o.xp6(12),o.Q6J("disabled",e.isReadOnly)("readonly",e.isReadOnly),o.xp6(1),o.Q6J("ngIf",e.isDownloadIconShow),o.xp6(4),o.Q6J("readonly",e.isReadOnly),o.xp6(4),o.Q6J("disabled",e.isReadOnly),o.xp6(6),o.Q6J("ngIf","state_officer"==e.loginUser||"/new-proposal"==e.currentUrl),o.xp6(1),o.Q6J("ngIf","state_manager"==e.loginUser&&"/new-proposal"!=e.currentUrl),o.xp6(1),o.Q6J("ngIf","morth_manager"==e.loginUser&&"/new-proposal"!=e.currentUrl),o.xp6(1),o.Q6J("ngIf","state_manager"==e.loginUser&&"/new-proposal"!=e.currentUrl),o.xp6(1),o.Q6J("ngIf","state_manager"==e.loginUser&&"/new-proposal"!=e.currentUrl))},dependencies:[u.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u],styles:[".download-proposal-icon[_ngcontent-%COMP%]{float:right;position:relative;top:-31px;right:10px;color:#d2691e}"]}),n})();function T(n,l){if(1&n){const t=o.EpF();o.TgZ(0,"tr")(1,"th",6),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.TgZ(5,"td"),o._uU(6),o.qZA(),o.TgZ(7,"td"),o._uU(8),o.qZA(),o.TgZ(9,"td")(10,"button",7),o.NdJ("click",function(){const s=o.CHM(t).$implicit,c=o.oxw(2);return o.KtG(c.onView(s))}),o._uU(11,"view"),o.qZA()()()}if(2&n){const t=l.$implicit,e=o.oxw(2);o.xp6(2),o.hij("#",t.id,""),o.xp6(2),o.Oqu(t.purpose),o.xp6(2),o.Oqu(e.date),o.xp6(2),o.Oqu(t.status)}}function C(n,l){if(1&n&&(o.TgZ(0,"div")(1,"table",3)(2,"thead")(3,"tr")(4,"th",4),o._uU(5,"Proposal number"),o.qZA(),o.TgZ(6,"th",4),o._uU(7,"Purpose"),o.qZA(),o.TgZ(8,"th",4),o._uU(9,"Submitted for approval on"),o.qZA(),o.TgZ(10,"th",4),o._uU(11,"Status"),o.qZA(),o.TgZ(12,"th",4),o._uU(13,"Action"),o.qZA()()(),o.TgZ(14,"tbody"),o.YNc(15,T,12,4,"tr",5),o.qZA()()()),2&n){const t=o.oxw();o.xp6(15),o.Q6J("ngForOf",t.proposalList)}}const U=[{path:"new-proposal",component:f},{path:"edit-proposal",component:f},{path:"proposal-list",component:(()=>{class n{constructor(t){this.router=t,this.proposalList=[],this.date=(new Date).toLocaleDateString()}ngOnInit(){let t=localStorage.getItem("proposalData");t=JSON.parse(t),t&&t.length>0&&(this.proposalList=t)}onView(t){console.log("proposal=",t),JSON.stringify(t),this.router.navigate(["edit-proposal",{items:t.id}])}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(p.F0))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-proposal-list"]],decls:5,vars:1,consts:[[2,"padding","80px"],[1,"sub-header"],[4,"ngIf"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0)(1,"div",1)(2,"h5"),o._uU(3,"Proposal List"),o.qZA()(),o.YNc(4,C,16,1,"div",2),o.qZA()),2&t&&(o.xp6(4),o.Q6J("ngIf",e.proposalList&&e.proposalList.length>0))},dependencies:[u.sg,u.O5]}),n})()}];let v=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[p.Bz.forChild(U),p.Bz]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[u.ez,v]}),n})()}}]);